<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CSV to XLS Converter</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin-top: 40px; }
        #drop-area { border: 2px dashed #aaa; padding: 30px; width: 350px; text-align: center; margin-bottom: 20px; }
        #file-input { display: none; }
        button { margin: 10px 0; padding: 10px 20px; font-size: 1rem; }
    </style>
</head>
<body>
    <h2>CSV to XLS Converter</h2>
    <div id="drop-area">
        <p>Drag & drop your CSV file here<br>or</p>
        <button onclick="document.getElementById('file-input').click()">Select File</button>
        <input id="file-input" type="file" accept=".csv">
    </div>
    <div id="output"></div>
    <script>
        const dropArea = document.getElementById('drop-area');
        const fileInput = document.getElementById('file-input');
        const output = document.getElementById('output');

        function handleFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const csv = e.target.result;
                const workbook = XLSX.read(csv, { type: 'string' });
                // If CSV, convert to workbook with one sheet
                let ws;
                if (workbook.SheetNames.length > 0) {
                    ws = workbook.Sheets[workbook.SheetNames[0]];
                } else {
                    ws = XLSX.utils.aoa_to_sheet(XLSX.utils.sheet_to_json(csv, {header:1, raw:true}));
                }
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                XLSX.writeFile(wb, "output.xlsx");
                output.innerHTML = "<b>âœ… Download started: output.xlsx</b>";
            };
            reader.readAsText(file);
        }

        // Drag & drop
        dropArea.addEventListener('dragover', e => { e.preventDefault(); dropArea.style.background = "#f0f0f0"; });
        dropArea.addEventListener('dragleave', e => { dropArea.style.background = ""; });
        dropArea.addEventListener('drop', e => {
            e.preventDefault(); dropArea.style.background = "";
            if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
        });
        // File input
        fileInput.addEventListener('change', e => {
            if (fileInput.files.length) handleFile(fileInput.files[0]);
        });
    </script>
</body>
</html>
